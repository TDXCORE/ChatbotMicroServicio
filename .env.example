# ================================
# OpenAI Configuration (OBLIGATORIO)
# ================================
OPENAI_API_KEY=sk-your-openai-key-here
OPENAI_MODEL=gpt-4-1106-preview
OPENAI_MAX_TOKENS=1000
OPENAI_TEMPERATURE=0.1

# ================================
# WhatsApp Configuration (OBLIGATORIO)
# ================================
# Path donde se almacena la sesión de WhatsApp (CRÍTICO: debe ser persistente)
WHATSAPP_SESSION_PATH=./session

# Modo headless para WhatsApp Web.js (true en producción, false para desarrollo)
WHATSAPP_HEADLESS=true

# Configuración del navegador para WhatsApp Web.js
WHATSAPP_BROWSER_ARGS="--no-sandbox,--disable-setuid-sandbox,--disable-dev-shm-usage"

# ================================
# Redis Configuration (OBLIGATORIO)
# ================================
# URL de conexión a Redis (local development / Render production)
REDIS_URL=redis://localhost:6379

# TTL para sesiones en Redis (en segundos - 7200 = 2 horas)
REDIS_SESSION_TTL=7200

# Configuración de conexión Redis
REDIS_MAX_CONNECTIONS=20
REDIS_RETRY_ON_TIMEOUT=true

# ================================
# Rate Limiting (RECOMENDADO)
# ================================
# Límite de mensajes por usuario por ventana de tiempo
RATE_LIMIT_PER_USER=10

# Ventana de tiempo para rate limiting (en segundos)
RATE_LIMIT_WINDOW=60

# Intervalo mínimo entre mensajes WhatsApp (para evitar bans)
WHATSAPP_MESSAGE_DELAY=1.5

# ================================
# FastAPI Configuration
# ================================
# Puerto para el servidor FastAPI
PORT=8000

# Configuración CORS (para desarrollo local usar "*")
CORS_ORIGINS=*

# Clave secreta para JWT tokens (si se implementa autenticación)
SECRET_KEY=your-secret-key-change-this-in-production

# ================================
# Environment Configuration
# ================================
# Environment: development, staging, production
ENVIRONMENT=development

# Nivel de logging: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO

# Base URL del servicio (para webhooks)
BASE_URL=http://localhost:8000

# ================================
# Database Configuration (SQLite)
# ================================
# URL de base de datos SQLite para persistencia
DATABASE_URL=sqlite:///./whatsapp_chatbot.db

# ================================
# Render Deployment Configuration
# ================================
# Configuraciones específicas para deployment en Render
RENDER_EXTERNAL_URL=https://your-app-name.onrender.com

# Configuración de workers para background tasks
MAX_WORKERS=4

# ================================
# Intent Classification Configuration
# ================================
# Threshold de confianza para clasificación de intenciones
INTENT_CONFIDENCE_THRESHOLD=0.7

# Configuración de fallback cuando OpenAI falla
USE_FALLBACK_CLASSIFICATION=true

# ================================
# Department Routing Configuration
# ================================
# Emails de departamentos para enrutamiento
SALES_EMAIL=ventas@empresa.com
SUPPORT_EMAIL=soporte@empresa.com
BILLING_EMAIL=facturacion@empresa.com
GENERAL_EMAIL=info@empresa.com
COMPLAINT_EMAIL=gerencia@empresa.com
INFORMATION_EMAIL=info@empresa.com

# ================================
# Monitoring & Health Checks
# ================================
# Intervalo de health checks (en segundos)
HEALTH_CHECK_INTERVAL=30

# Timeout para health checks (en segundos)
HEALTH_CHECK_TIMEOUT=10

# ================================
# Memory Management
# ================================
# Límite máximo de tokens para contexto (para evitar límites OpenAI)
MAX_CONTEXT_TOKENS=6000

# Número máximo de mensajes en memoria por conversación
MAX_MEMORY_MESSAGES=20

# ================================
# Error Handling & Retries
# ================================
# Número máximo de reintentos para APIs externas
MAX_API_RETRIES=3

# Delay inicial para exponential backoff (en segundos)
INITIAL_RETRY_DELAY=1

# Multiplicador para exponential backoff
RETRY_MULTIPLIER=2

# Número máximo de intentos de reconexión para WhatsApp
MAX_WHATSAPP_RECONNECTION_ATTEMPTS=5

# ================================
# Security Configuration
# ================================
# Webhook token para validar requests entrantes (opcional)
WEBHOOK_SECRET=your-webhook-secret

# IP whitelist para webhooks (comma-separated)
ALLOWED_IPS=127.0.0.1,localhost

# ================================
# Development & Testing
# ================================
# Flag para habilitar modo development
DEBUG=false

# Flag para mock de servicios externos en testing
MOCK_EXTERNAL_SERVICES=false

# Path para archivos de test
TEST_DATA_PATH=./tests/data/